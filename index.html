<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Refleksomierzacz</title>
	<script>
	var start = false; //klikanie przycisku
	var click = false; // klikanie po polu
	var timeColour;
	var timeClick;
	var avgTime;
	var sumTime =0;
	var colours = ['green', 'blue', 'yellow', 'red', 'magenta', 'cyan', 'grey', 'pink'];
	var prevColour = 100;
	
	var gameStep;
	var num = 5;
// ------------- FUNKCJA ZMIANY KOLORU POLA GRY --------------------	
function changeColour(){
var randomColour;
 do {
 randomColour = parseInt(Math.random()* 10);}
 while (randomColour<= 0 || randomColour>colours.length || randomColour==prevColour);
 prevColour=randomColour;
 document.getElementById('pole-gry').style['background-color'] = colours[randomColour];

}
// ------------- FUNKCJA OBLICZANIA ŚREDNIEJ --------------------
function funAvgTime(){
var timeMs = timeClick - timeColour;
sumTime +=timeMs;
avgTime = sumTime/(gameStep+1); 
}

// ------------- FUNKCJA ODCZYTANIA CZASU KLIKNIECIA --------------------
function readTime(){
if (!click) {click = true;
timeClick = Date.now();
funAvgTime();
document.getElementById('kontrola').innerHTML=avgTime;

}
}

// ------------- FUNKCJA ZMIANY CZASU PO KTÓRYM NASTĘPUJE ZMIANA KOLORU POLA GRY --------------------
function timeToChangeColour(){
console.log('timeToChangeColour');
    changeColour();
	timeColour = Date.now();
	click = false;
    gameStep++;
    if(gameStep < num){
        var randomTime = parseInt(Math.random()*3000);
		//document.getElementById('kontrola').innerHTML=randomTime;
		setTimeout(() => timeToChangeColour(), randomTime);
        //setTimeout(timeToChangeColour, randomTime);
    }
	
}
	
// ------------- FUNKCJA URUCHOMIENIA GRY --------------------
function playGame(){
gameStep = 0;
document.getElementById('pole-gry').innerHTML="";
    timeToChangeColour();  
	


}

// ------------- FUNKCJA WYCZYSZCZENIA GRY --------------------
function clearGame(){
start = false;
gamestep = 0;
sumTime =0;
avgTime = undefined;
document.getElementById('przycisk').innerHTML="Start";
document.getElementById('pole-gry').style['background-color'] = document.fgColor;
document.getElementById('pole-gry').innerHTML="";
document.getElementById('kontrola').innerHTML=avgTime;

}


// ------------- FUNKCJA OBSŁUGI PRZYCISKU --------------------
	function startStopGame(){
if (start == false){
start = true;
click = false;

document.getElementById('przycisk').innerHTML="STOP";
document.getElementById('pole-gry').style['display'] = 'block';
document.getElementById('pole-gry').innerHTML="Gra rozpoczęta";
setTimeout(() => playGame(), 2000);
}
else clearGame();
}

	
	</script>
    <style>
        body {
		background-color: papayawhip;
            margin: 10px;
            padding: 0;
            font-family: Arial, serif;
        }

        h1 {
            color: #0B3954;
        }
		.green { color:green;}
		
		#pole-gry {
			width:300px;
			height:200px;
			margin: 100px;
			padding: 100px;
			border: solid 2px black;
			text-align: center;
			font-size: 30px;
			#background-color: red;
			display: none;
			}
		button { width: 300px;
		height: 100px;
		margin-left: 100px;
		}
    </style>
</head>
<body>
<div id="app">
    <h1 id="main-header">Refleksomierzacz</h1>
    <p>mierzy refleks użytkownika, mierząc czas pomiędzy zmianą na ekranie a kliknięciem myszy</p>
	<button type="button" onclick="startStopGame()" id = 'przycisk'>Start</button>
    <div id = "pole-gry" onclick="readTime()">
	<p> </p>
	</div>
	<p id = "kontrola"></p>
</div>

<br>

<script>


</script>
</body>
</html>